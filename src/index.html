<html>
<head>
<script>
const PIXI = require('pixi.js');
</script>
<meta charset="UTF-8">
<title>タイトル</title>
</head>
<body>
<h1>Sample</h1>
<script>
let app = new PIXI.Application({ 
    width: 256, 
    height: 256,                       
    antialias: true, 
    transparent: false, 
    resolution: 1
  }
);

document.body.appendChild(app.view);

class ChartTick {
  constructor(opt) {
    this.dt    = opt.dt;
    this.low   = opt.l;
    this.hight = opt.h;
    this.start = opt.s;
    this.end   = opt.e;

    this.x = 0;
    this.y = 0;
    this.width = 1;
    this.height = 1;

    this.sprite = null;

  }

  getSprite() {
    //rectangle.lineStyle(4, 0xFF3300, 1);
    if (this.sprite == null) {
      let g = new PIXI.Graphics();
      g.beginFill(0x66CCFF);
      g.drawRect(0, 0, 1, 1);
      g.endFill();
      this.sprite = new PIXI.Sprite(g.generateTexture());
      this.sprite.x = this.x;
      this.sprite.y = this.y;
    }
    return this.sprite;
  }

  setPosition(x,y,w,h) {
    this.x = x;
    this.y = y;
    this.width  = w;
    this.height = h;
    if (!this.sprite) {
      return;
    }
    this.sprite.x = x;
    this.sprite.y = y;
    this.sprite.width  = w;
    this.sprite.height = h;
  }
}

class ChartContainer {
  
  constructor(opt) {
    this.width  = opt.width;
    this.height = opt.height;
    this.ChartTicks = [];
    this.Container = new PIXI.Container();
  }
  
  addChartTick(ct) {
    this.ChartTicks.push(ct);
  }

  setChartPos() {
    let vx = this.width - 5;
    this.ChartTicks.forEach(function(obj){
      obj.setPosition(vx, 50, 2, 50);
      vx -= obj.width + 2;
    });
  }

  cleanup() {
    //this.Container.destroy(true);
  }

  draw() {
    this.setChartPos();
  }

  setup() {
    let that = this;
    this.ChartTicks.forEach(function(obj){
      let sp = obj.getSprite();
      that.Container.addChild(sp);
    });
    this.draw();
  }

  getContainer() {
    return this.Container;
  }
}

var chartContainer = new ChartContainer({width:255, height:255});
chartContainer.addChartTick(new ChartTick({dt:new Date(),l:1,h:2,s:3,e:4}));
//chartContainer.addChartTick(new ChartTick({dt:new Date(),l:5,h:6,s:7,e:8}));
console.log(chartContainer);

PIXI.loader
  .add("img/test.png")
  .load(setup);

function setup() {
  //Create the cat sprite
  let cat = new PIXI.Sprite(PIXI.loader.resources["img/test.png"].texture);

  chartContainer.setup();
  app.stage.addChild(chartContainer.getContainer());

  //Add the cat to the stage
  app.stage.addChild(cat);

}


</script>
</body>
</html>